<!--
  YouTube Embed Relay â€” fixes WKWebView Error 153.
  Based on https://stackoverflow.com/a/79810109 by Bart (CC BY-SA 4.0).

  WKWebView's loadHTMLString omits the Referer header that YouTube requires.
  By setting baseURL to youtube-nocookie.com and using an iframe with
  referrerpolicy="strict-origin-when-cross-origin", the embed request
  carries the correct Referer and avoids Error 153.

  The placeholder {{VIDEO_ID}} is replaced at runtime by Swift before loading.
-->
<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <meta name="referrer" content="strict-origin-when-cross-origin" />
  <title>YouTube Embed Relay</title>
  <style>
    html, body { height: 100%; margin: 0; background: #000; }
    iframe { width: 100%; height: 100%; border: 0; display: block; }
  </style>
</head>
<body>
  <iframe
    id="player"
    allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; fullscreen"
    allowfullscreen
    referrerpolicy="strict-origin-when-cross-origin"
  ></iframe>

  <script>
    (function() {
      var videoId = '{{VIDEO_ID}}';
      if (!videoId || videoId === '{{' + 'VIDEO_ID}}') {
        document.body.textContent = 'Missing video ID';
        return;
      }
      var base = 'https://www.youtube-nocookie.com/embed/' + encodeURIComponent(videoId);
      var params = new URLSearchParams({
        enablejsapi: '1',
        rel: '0',
        modestbranding: '1',
        playsinline: '1',
        autoplay: '0',
        origin: location.origin
      });
      document.getElementById('player').src = base + '?' + params.toString();
    })();
  </script>
</body>
</html>
